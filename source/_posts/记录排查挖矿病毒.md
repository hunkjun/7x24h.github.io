---
title: 记录排查挖矿病毒
date: 2024-03-11 16:56:50
tags: 技术
---

## 问题描述

最近在一次常规的系统维护中，注意到一台服务器的CPU使用率异常高。进一步的调查显示，这是由一个挖矿病毒引起的。即使我清除了相关的定时任务crontab并删除了可疑文件，病毒仍然能够自我恢复。

![alt text](/images/crontab-image.png)

![alt text](/images/top-image.png)


## 排查和处理过程

1. 通过 top 命令，能够监控到异常进程的名称和ID，这是定位问题的第一步。
2. 通过观察进程树systemctl status PID，确定了关联的子进程ID，是找到病毒行为的关键。
3. 使用 kill 命令结束了所有相关进程及其子进程，阻止病毒的当前活动。
4. 借助find 和 ps进程显示信息，根据 ls -a --full-time 文件时间，尝试删除病毒文件，包括 /usr/bin/.system/ 和 /tmp 等.
5. 病毒如何进入，暂未知, 需进一步排查。以防下次再来。
